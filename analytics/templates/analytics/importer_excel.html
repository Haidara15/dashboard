{% extends "base.html" %}
{% load static %}
{% block content %}

<link rel="stylesheet" href="{% static 'css/creation.css' %}">

<style>
  .hidden {
    display: none;
  }
  .hidden-color {
    display: none;
  }
</style>

<div class="excel-container">

  <!--Barre latÃ©rale pour les filtres -->

  <div class="excel-sidebar" id="sidebar">

    <button id="toggle-sidebar" class="toggle-btn">â¬…</button>

    <h2>ðŸ“‚ Importer Excel</h2>

    <form id="excel-upload-form" method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <input type="file" name="excel_file" id="excel-file" accept=".xlsx" required>
    </form>

    <form method="post" action="{% url 'creer_graphique_excel' slug=slug %}">
      {% csrf_token %}

      <div id="colonnes-container" class="hidden"></div>

      <label for="id_titre">Titre :</label>
      <input type="text" name="titre" id="id_titre" required>

      <label for="id_type">Type de graphique :</label>
      <select name="type" id="id_type">
        <option value="bar" selected>Barres</option>
        <option value="line">Lignes</option>
        <option value="pie">Camembert</option>
      </select>

      <label for="id_description">Description :</label>
      <textarea name="description" id="id_description" rows="3"></textarea>

      <label for="titre-x">Titre axe X :</label>
      <input type="text" name="titre-x" id="titre-x">

      <label for="titre-y">Titre axe Y :</label>
      <input type="text" name="titre-y" id="titre-y">

      <input type="hidden" name="series_data" id="series-data-json">

      <button type="submit" class="submit-btn">âœ… Enregistrer le graphique</button>
    </form>
  </div>

<!--Mainpanel pour afficher le graphique de prÃ©visualisation -->

<div class="excel-main">
    <canvas id="preview-chart"></canvas>
  </div>
  
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script src="{% static 'js/creation.js' %}"></script>

{% endblock %}
