{% load static %}
{% block content %}

<!-- Feuilles de style -->
<link rel="stylesheet" href="{% static 'css/formulaire.css' %}">
<link rel="stylesheet" href="{% static 'css/sidebar.css' %}">

<!-- Bouton toggle externe -->
<button class="toggle-sidebar-btn" id="toggleSidebar" title="Afficher/masquer le menu">â˜°</button>

<!-- Conteneur principal -->
<div class="layout" id="layout">

  <!-- Sidebar -->
  <div class="excel-sidebar" id="sidebar">
    <h2>ðŸ“‚ Importer Excel</h2>

    <form id="excel-upload-form" method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <input type="file" name="excel_file" id="excel-file" accept=".xlsx" required>
    </form>

    <form method="post" action="{% url 'creer_graphique_excel' slug=slug %}">
      {% csrf_token %}

      <div id="colonnes-container" class="hidden"></div>

      <label for="id_titre">Titre :</label>
      <input type="text" name="titre" id="id_titre" required>

      <label for="id_type">Type de graphique :</label>
      <select name="type" id="id_type">
        <option value="bar" selected>Barres</option>
        <option value="line">Lignes</option>
        <option value="pie">Camembert</option>
      </select>

      <label for="id_description">Description :</label>
      <textarea name="description" id="id_description" rows="3"></textarea>

      <label for="titre-x">Titre axe X :</label>
      <input type="text" name="titre-x" id="titre-x">

      <label for="titre-y">Titre axe Y :</label>
      <input type="text" name="titre-y" id="titre-y">

      <input type="hidden" name="series_data" id="series-data-json">

      <button type="submit" class="submit-btn">âœ… Enregistrer le graphique</button>
    </form>
  </div>

  <!-- Zone principale -->
  <div class="excel-main">
    <canvas id="preview-chart"></canvas>
  </div>

</div>

<!-- Scripts -->
<script src="{% static 'js/sidebar.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{% static 'js/import_excel.js' %}"></script>

{% endblock %}
